<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>剪贴板</title>
</head>
<body>
  <section>
    <p>复制输入框的文字</p>
    <input type="text" id="input" />
    <button id="btn">复制</button>
  </section>
  <section>
    <p>复制预设的文字</p>
    <button id="btn-preset">复制</button>
  </section>
  <section>
    <p>复制预设的文字，进行了函数嵌套</p>
    <button id="btn-fc">复制名字</button>
    <button id="btn-fc-desc">复制详情</button>
  </section>
  <section>
    <p>复制预设的文字，但是异步获取的（Promise）</p>
    <button id="btn-promise">复制</button>
  </section>
  <section>
    <p>复制预设的文字，但是异步获取的（Await）</p>
    <button id="btn-await">复制</button>
  </section>
  <script>
    const input = document.querySelector("#input");
    const btn = document.querySelector("#btn");

    // 输入框
    btn.onclick = () => {
      if (navigator.clipboard) {
        navigator.clipboard.writeText(input.value);
      }
    };

    // 预设
    const btnPreset = document.querySelector("#btn-preset");
    
    btnPreset.onclick = () => {
      if (navigator.clipboard) {
        navigator.clipboard.writeText("复制了一段预设的文本");
      }
    }

    // 嵌套
    const btnFc = document.querySelector("#btn-fc");
    const btnFcDesc = document.querySelector("#btn-fc-desc");

    const copyToClipboard = (text) => {
      if (navigator.clipboard) {
        navigator.clipboard.writeText(text).then(() => {
          console.log("复制成功");
        }).catch((e) => {
          console.log("复制失败", e);
        });
      }
    }

    const copyContent = (type) => {
      if (type === "name") {
        copyToClipboard("名字");
      }

      if (type === "desc") {
        copyToClipboard("介绍内容");
      }
    }

    btnFc.onclick = () => copyContent("name");
    btnFcDesc.onclick = () => copyContent("desc");

    // 异步 Promise
    const btnPromise = document.querySelector("#btn-promise");

    btnPromise.onclick = () => {
      new Promise((resolve, reject) => {
        setTimeout(() => {
          resolve("异步 Promise 获取的文字内容");
        }, 500);
      }).then((text) => {
        copyToClipboard(text);
      });
    }

    // 异步 Await
    const btnAwait = document.querySelector("#btn-await");

    btnAwait.onclick = async () => {
      const text = await new Promise((resolve, reject) => {
        setTimeout(() => {
          resolve("异步 Await 获取的文字内容");
        }, 500);
      });

      copyToClipboard(text);
    }
  </script>
</body>
</html>
